import os
import redis
import base64
def extract_sold_item_info(payload:dict):
    
    retDict = {}
    temp = payload['payload']
    sale_price_str = test['payload']['sale_price']
    usd_price_str = test['payload']['payment_token']['usd_price']

    # Convert the sale price and USD price to float
    sale_price = float(sale_price_str) / 1e18
    usd_price = float(usd_price_str)

    # Calculate the total sale price in USD
    total_usd = sale_price * usd_price

    # Format the total sale price with comma separation and two decimal places
    formatted_usd = "{:,.2f}".format(total_usd)

    retDict['chain']=temp['chain']
    retDict['from_address']=temp['maker']['address']
    retDict['to_address']=temp['taker']['address']
    #payload.item.metadata.image_url
    retDict['image_url']=temp['item']['metadata']['image_url']
    retDict['nft_name']=temp['item']['metadata']['name']
    retDict['nft_link']=temp['item']['permalink']
    retDict['amount_symbol'] = payload['payload']['payment_token']['symbol']
    retDict['amount_token'] = int(payload['payload']['sale_price']) / (10 ** int(payload['payload']['payment_token']['decimals']))
    retDict['amount_usd'] = formatted_usd
    retDict['encoded_nft_link'] = base64.urlsafe_b64encode(retDict['nft_link'].encode()).decode()
    return retDict

r = redis.from_url(os.environ["REDIS_URL_DOGS"])
current_token=r.get("token")
current_save_token=r.get("save_token")

print(f"current_token: {current_save_token}")

print(f"current_save_token: {current_save_token}")
test={'event_type': 'item_sold', 'payload': {'chain': 'avalanche', 'closing_date': '2024-01-23T04:17:33.000000+00:00', 'collection': {'slug': 'coqvshunter'}, 'event_timestamp': '2024-01-23T04:17:33.000000+00:00', 'is_private': False, 'item': {'chain': {'name': 'avalanche'}, 'metadata': {'animation_url': None, 'image_url': 'https://raw.seadn.io/files/80ff5ff5c7e41fc9a6c181611951d3f3.svg', 'metadata_url': 'data:application/json;base64,eyJuYW1lIjogIkNvcSAjMjQ4MTgiLCAiZGVzY3JpcHRpb24iOiAiVGhvdXNhbmRzIG9mIENoaWNrZW5zIGFuZCBIdW50ZXJzIGNvbXBldGUgb24gYSBmYXJtIGluIHRoZSBtZXRhdmVyc2UuIEEgdGVtcHRpbmcgcHJpemUgb2YgJEdFR0dTIGF3YWl0cywgd2l0aCBkZWFkbHkgaGlnaCBzdGFrZXMuIEFsbCB0aGUgbWV0YWRhdGEgYW5kIGltYWdlcyBhcmUgZ2VuZXJhdGVkIGFuZCBzdG9yZWQgMTAwJSBvbi1jaGFpbi4gTm8gSVBGUy4gTk8gQVBJLiBKdXN0IHRoZSBBdmFsYW5jaGUgYmxvY2tjaGFpbi4iLCAiaW1hZ2UiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCcFpEMGlhSFZ1ZEdWeUlpQjNhV1IwYUQwaU1UQXdKU0lnYUdWcFoyaDBQU0l4TURBbElpQjJaWEp6YVc5dVBTSXhMakVpSUhacFpYZENiM2c5SWpBZ01DQXlNREFnTWpBd0lpQjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIaHRiRzV6T25oc2FXNXJQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh4T1RrNUwzaHNhVzVySWo0OGFXMWhaMlVnZUQwaU1DSWdlVDBpTUNJZ2QybGtkR2c5SWpJd01DSWdhR1ZwWjJoMFBTSXlNREFpSUdsdFlXZGxMWEpsYm1SbGNtbHVaejBpY0dsNFpXeGhkR1ZrSWlCd2NtVnpaWEoyWlVGemNHVmpkRkpoZEdsdlBTSjRUV2xrV1UxcFpDSWdlR3hwYm1zNmFISmxaajBpWkdGMFlUcHBiV0ZuWlM5d2JtYzdZbUZ6WlRZMExHbFdRazlTZHpCTFIyZHZRVUZCUVU1VFZXaEZWV2RCUVVGTlowRkJRVVJKUVZGTlFVRkJRMWhzYW5wa1FVRkJRVUV4UWsxV1JWaDRPRkJUT1VWUVQwWkJRVUZCU0VWc1JWRldVbGwzS3pOQ1oxRkJRVUZCUkVSdlVHeFVXQ3RGUVZaUlJVRkJRVUZCWmtGWlZWVkJRVUpCU2pocVJsRkJRVUZCUWtwU1ZUVkZjbXRLWjJkblBUMGlMejQ4YVcxaFoyVWdlRDBpTUNJZ2VUMGlNQ0lnZDJsa2RHZzlJakl3TUNJZ2FHVnBaMmgwUFNJeU1EQWlJR2x0WVdkbExYSmxibVJsY21sdVp6MGljR2w0Wld4aGRHVmtJaUJ3Y21WelpYSjJaVUZ6Y0dWamRGSmhkR2x2UFNKNFRXbGtXVTFwWkNJZ2VHeHBibXM2YUhKbFpqMGlaR0YwWVRwcGJXRm5aUzl3Ym1jN1ltRnpaVFkwTEdsV1FrOVNkekJMUjJkdlFVRkJRVTVUVldoRlZXZEJRVUZOWjBGQlFVUkpRMEZOUVVGQlEyRm9iRFp6UVVGQlFWWkdRazFXUlZaSVkwVjVVMVpDU3pSWlJGcE5hR2R6VWtWNFR5OVNRazlaY21GTFpYSTJObVZ5TmpSQ1FWRkdMek5UWm1GVFFrY3ZVa0pVYzFGM1NpczBaMDVOYUVFMU4zcDNVMEUxZDB0bGNqWTJZWEp0YkVObVVVZE9ia3B6UVVGQlEyWnpTeXROYlRWeWMxSkJUamszVVV4WlUzaFlka3hVVUVsQlFVRkJSbTVTVTFSc1RVRk1kMkk1TDNZMFl6WkRhR2xYYlVkc2RHOURSaXMzUzJScGRGQTRVM0E0YzFsUlFVRkJUMDVLVWtWR1ZXVk9jblF5WkRGUFozcEJRV2gxUmxOT1oxcFVUamRpTkVJNWVpOW1WbTlxU201d2NVTnZOM1ZsVlRVMkwwOWFUREp2VFVkQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkVORGRsUjBoTGJYaFlaa0p4VTJGYWNqSjVaVkJYVVRaYVVFcFpVVTFDV1ZWTlVsbFJhelZaVkhOTVYwdFNla05JZWtkclNuVkxWMUYyTlVsYVZYbGhXSFlyTVUwMmJUZENlR3d6UldOcWVVVlNTV2xUU0VkTkwwcGhWbUZHTjJGeWNYQlFPV1ZSTkdsUllrcHdlbFZyU2tsRmIzVTFaWEZOTTBwSlpsazFaazVqTVM5WEwyaFdVemN4Tm5jMlNXWmpaVVZ3YzNZeFV6WjJjbkJ0Um14aVUwZ3lZM1EzVm05bVdrNWhlbXNyY21Gek1WVk1ZVkZyVEdrNFlrTnpNVkpoU2pkaVNXRklNMmRCUVVGQlFVRkJRVUZCVUVKWVNEWlFSbEkxY200dlNIa3lRVUZCUVVGRmJFWlVhMU4xVVcxRFF5SXZQanhwYldGblpTQjRQU0l3SWlCNVBTSXdJaUIzYVdSMGFEMGlNakF3SWlCb1pXbG5hSFE5SWpJd01DSWdhVzFoWjJVdGNtVnVaR1Z5YVc1blBTSndhWGhsYkdGMFpXUWlJSEJ5WlhObGNuWmxRWE53WldOMFVtRjBhVzg5SW5oTmFXUlpUV2xrSWlCNGJHbHVhenBvY21WbVBTSmtZWFJoT21sdFlXZGxMM0J1Wnp0aVlYTmxOalFzYVZaQ1QxSjNNRXRIWjI5QlFVRkJUbE5WYUVWVlowRkJRVTFuUVVGQlJFbERRVTFCUVVGRFlXaHNObk5CUVVGQ1FsWkNUVlpGVmtoalJYZEVRV2RKUjBKQlVVRkJRVUZCUVVGQ2QxbHRSV1JHZUdOVlEyZEZTRUpSVld0SVVqQkJRVUZFTm1wM05FTkJVVUZCUVVGQlVVUlJNMlZoWjFsQlFVRkVhMlZuZGpKbFVYZEVRWGROUVVGQlFteFdSa3BZVkdzd1FrRkJSR3RrVVdvNGJuaEJSVUZuUkc1aVFVaHRZa0ZJTjI5Qkt6ZFpVazV1VDNkU2FsVnNRa0ZIVVVSWmNFaHVja2xuV1haTGVYRkJWWGR1VDFsUlJVRkJRVU5XYVZsb2NWZFdabTVpUVVaQlRFTnZja3BEVUU1NVRXUm5WVEZNV0hvNGRWbHFTWE5XUlVFclZXZzBZVkJuTkV3NWNFSkdTRkJFZGtKMU4yMUdaVWhsYW0xS1pHVlVWWE14U21sWFFXTnVSRGxtZUVJMFlWZG9WbE13Y2toSFVVZGxhelZLUlU1RVMzVndjVmhKZHpoS05HTkhLekp6VEVFelRWUkRPRmxTUmxCU1ZWUmhXbmRNTW10M2VrUlFVMjV5YVdwYU1FaG5RVFJHUVU5VWExcElNV1ZCZGpscmFFZzJTa0ZsYUdOWFR6RldVVkIyU1hkbVlraG5VM1pGZERGRlFVRkJRVW96VWxOVWJFMUJiM1UzUXpCMk56bEVVRGNyVEZjclFVWjJjV0pSYTFOblZtNUljeXN5VFdwdE5DOW5PWEZ3ZVM5aWFXc3ZjSHBMZDNWbVNtTndURVJCUVVGRllUQnNSVkZXVWpReWRUTmlaVEF2YVZkQ2FraGpVa0ppVjNOQmNreFBTbXg0TTFoWU0ySmlVVXMxTUZkRGFHRkNRWFZMVFRaNmNrOTFUeTh2Y0dWNGVrdEZNRnBaVG5oclJXMWtUMnM1T0c1S2NFdEVMM1pJVGpBMFpWTkxSR3RCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFXZFBPVmhZU2toTWMwWkthRTR6VjFsNU5qVkVVMVZzVmtWbVMxUXdWbGxqTjJ0emVEWndRVzlLU2s4M1ZXbHpWVU4wWmk5NFRubzJaa1EzTDJwV2VsUlpaRmx0WXpCYVZHMVFiRkpHVUcwclVIaFZNRkZtZFVZMlNGSlplVE5FU1ZkT1FUQkpZM05vZFdzNFpEaFZVekJVUlRkcmMwWmhjbGhrWm5Kbk1HeHJSMDVHTUU5b01UTlRRMmRKWjJsbWNtVndObVY2VFhGbE5VSldSa1ZZZUdsWFNXSkNVWEp5WkZsa1puUmtlbkJEZGxZMWJsVjVhMVZ6ZUZGNVdsTklWMWxwVEZWTldGUTNMMkkyVjJodFVuZEpjVkUzU0VaS1NVb3hUV2hTSzFaNUsyTXZUSGs0ZGxCMmVGQk1jMUI0U2t0RmVrZDRTMWs1YldSRFpYcE1ORlp6Ym1OVGNTOUtVaXRsZGpjeVMyVmliVFZ6U0hjM1RFZHJjVXhKTUhscFMzVnRNMVpXYkZoV09YUkxVVGRYT1c5a2RtdFBUVk5wUlZwRWRFVmFRbEJLV0UxcFNESk5NMVF3T1U5RVdsWnVWSFZsWlZwMmJVVlpXVGwxTWpJMk4zSmlaekJ3Vm1GMlZtbHJWRFJEVkd4MWNHZzBjMWxyVTFKM1pFUk9jRTkyVTNkdE9XUTVhbmRrVTNaMVJXNDFRMFJxV2tOWmJGbFRUVmhuTTJobVUwcFhRbWxrZVdOWU5TdDJPVU00V0RWc1NVZDFURkpLYUZReU1YTlJhRWxyT0doRVdFeHNUMDAzWm5RM1pUTklPV3d5VEVsaWFTczVSMWszZFRVNVZGSlFUVkZTUWpSMU1uWkZTbGxsV0d0UVVrTlRWVTlKVkRkeFRHdE9hR05YWlZCSmFrTnFla2Q0U1d4RkwwaGFVazFLV0ZGNmFXTkRTek5DU1hOVFVFWnFUWGd4YVdONWEwSktjMDUzYVc1RkwyNXFUblpoZUU5NE5UTnRVMGQ0WW1SV01teDZjVlI1VTFSVlZFMHpNRnB5VDFwU01sazJXVk50WTJoVWR5OVFMeTlNVVc5aVZXOU1XbW8yYVhBeWJEVXJVVUZWV0UxQ05GQkNVMDhyZUVWd00zSnJSemwzZG5jMmFFVndiUzlyU21WWWJEbFhVWFJyZG1GeU5HWXdNa1ZDYTNwclMzVklhRGhtWnpndlJVcHhjWEZrZEdwc1REbG9jVXR4YldKUFdUZFVSelF4UjB4aU0xZzBNMEpJTWsxMmRtZElXbUpxV0daRU4ydDBNRzlPYm5Gb2NscFBWRGhwZEZaeGRFZ3JRVEZTYkhsR2NUTXZiaTlGU2pONlJVaFdiRWx5WVdReVdXdFJUbkJGVDNVd01UUjBUazlVWWxORk9WZDJhRVpwVTJsTGRUSmtibHA2VlN0UmVHaFlTWHBKWkcxMllWZHJSa1ZSUWtJMllubHpOMDlVYWpSWWVUTTFTVTFUYzJoWU1VNWFlVU4zVGpKbFkzZGFUalJvTjJWVVpVWTBZV2g0TDJKRldFMVBWMW93TjJack5VRkRabmxGZWtkdlRGRldiRTFvU0dWcVMyMXlhMmREUW5Cb1NXVjRTbWhNZUdSNVJXcFVkRWhCYkhCUU1YRjVTbnBRYTBwT09GQnVMM1JsWkRablVUbFRiRkIwYzFSWFdtSXhhRU5wU3poMGQwMTZRMEZaUWtNeE1sUnlPVlpMV0V3MWNIcG1Vak5JU2pWb1VsUllTbmxHY2tkTVZtbFVhbTlPU0d0UFl6ZFRTRGxLUTFGSmRrNVhVVWhNT0doaGQzUjJjalJsV1V0NFQxSlBRVEp3TUVneFlVUnplRUZqT1hSMWIzSXdTVmRXVTBWdlVrTlJWV0V2V0Zsc09Xa3ZVR0ZGVWpOMWJGVnhiVFkzZW1sNVNuRlJNRkowUVVVd2VIUTFTVGhoVWxscVdEWTJWRElyTHpadFJ6bHRVbFF3Um5KYVJHVlphMUo0UkhrMWEzQXdOVmwxUW5WVFJqVXlaVEl4WkhCWk5FUjViWGxRVWtka1ZGazVNMlF6WkdaaFJDOHlWREJ2YXpKUkwyVndOa3B6WlhKNGRrNXlPVWxwYVVsa05YQlpVVGh6VDFWd1JtUkRiRUY1UmpkT1ZYRnNZazVNWTJ4V1NsaFdNREJ0TXpsV1UwTnRXRXRaTTNwYWNrNDFiRVZ6WkZWamFEVk5WV1Y1U0ROSlVtZ3lRV2xRTVZOcVNFUjFORzlLUTBSamRteGtaV1Z0VldoaWQycHFWbmR0U0V3d2JrNDJVelU1UlZOUVVEbElXa0l6Y0RobU1HVlBSVWxMVVRjNVJUUktZMlpyV1U5dFdXNUVURXBSVVUxbVZGRkZRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFXZE1aakpJTW1waGRURmFMMXB6V0ZSQlFVRkJRVVZzUmxSclUzVlJiVU5ESWk4K1BHbHRZV2RsSUhnOUlqQWlJSGs5SWpBaUlIZHBaSFJvUFNJeU1EQWlJR2hsYVdkb2REMGlNakF3SWlCcGJXRm5aUzF5Wlc1a1pYSnBibWM5SW5CcGVHVnNZWFJsWkNJZ2NISmxjMlZ5ZG1WQmMzQmxZM1JTWVhScGJ6MGllRTFwWkZsTmFXUWlJSGhzYVc1ck9taHlaV1k5SW1SaGRHRTZhVzFoWjJVdmNHNW5PMkpoYzJVMk5DeHBWa0pQVW5jd1MwZG5iMEZCUVVGT1UxVm9SVlZuUVVGQlRXZEJRVUZFU1VOQlRVRkJRVU5oYUd3MmMwRkJRVUZhYkVKTlZrVlZRVUZCUkhka01IWXZPRXMzTDJKRlJDODRTM293WkVWeUwyUkZhaTg0WVRNdlpFVnlMM2xaY1V4U1Uwd3JWSGg2TDJjeFUwNVNRMFF2VjNseUwyRkVZVE5oVkdWVlUybGhRazlvWmk5bWF6YzVWMU5YYzFkVGNpOXBSbVZDVDJobUsxZFRXRGxWVWpjdmVGZEVMMjh4VEN0dlFpOHZaRVZNSzFWQ2VWUlRlV2xrVVdoaFFrOW9aa0pDY1drclFVRkJRVWR1VWxOVWJFMUJRbmhOVjBwcGJ6TlFSVUpLVmxZeGEyTllLMVZzV25samNHRTJNSFUzTDJJNVdVMWhhSFJSUVVGQlIxWlRWVkpDVmtocVlUZGtibVJpYjBsM1IwbEVhRGQ0VURabk1WUlpWbkpoYUZSeVltUXZNREoxYlVKc01UQXllVXBLYkhKNVVHaDVWVEI2WlVaR2JFbENRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZKYW05VFEyRm5jMDVaWVcxUlJHcDJZbU54SzFOMU9EbFZXalYwVHpaSVlYRklTMjF2Wm5KdFRYcFhSVnB4YlUxV1RVbGhWMDlOV0haSk16STBXWGRKTDJSRVpsRnFRbmxCVTNkQlpVczJkRVZxYTJkTE0zSXlkVmxaV1c0dk9HVnlWRVJOUkZGYVpIQjNUMWxWV25WU01EQnBRaXR4ZFRZMWNUWnljakZMTDNCd2FFZFFjVU5GUlV0MWRYRnRielpwTlVWS1ZtUk9NeTlsVG1NeVZUZG9iRlJ3VW1wTVZuQlpSRmRQWW1OTVkxUnhWa1ZOYkZWMU1YZDFNalp4Y1RSb2FWTlNjV1ZhZG1sak1taENSRGQyYmpoaWNHSkhjbE5zWms5S1JDdHNZM2sxZFU1d2RUTXdaVGQ0U1c5VFVWTjZOR055WkVkRWExQldjWFJXY201SFIwczVkSGhOU25OWVlXbE5OVXhyUjBaSldWVTBkMmh6TjBselVUUjZlRnBhTW10clQxWkVjMnBxU0hsQmJucDRZa2MxTTI1aWJGTnZZbXRKTTJ4UWRIVk9VR042Ym1nNVpsQlpObmd5UmpkRmRpdEVkRVptU1dONlNYQmxabkphYm5oUVdIQkpkV1ZWTkdWNmVrWjVkM1ZNY0RKUFNXMUpaVWczWVV0R01HVjRaWFpYYjFGUlNYVktSRU5JWVRkdWVIbFpVMWxhVlRrM1ptcDRaa1ZRUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVM5MWEweDRNM2N6UVhsM1dtaG1jMEZCUVVGQlUxVldUMUpMTlVOWlNVazlJaTgrUEdsdFlXZGxJSGc5SWpBaUlIazlJakFpSUhkcFpIUm9QU0l5TURBaUlHaGxhV2RvZEQwaU1qQXdJaUJwYldGblpTMXlaVzVrWlhKcGJtYzlJbkJwZUdWc1lYUmxaQ0lnY0hKbGMyVnlkbVZCYzNCbFkzUlNZWFJwYnowaWVFMXBaRmxOYVdRaUlIaHNhVzVyT21oeVpXWTlJbVJoZEdFNmFXMWhaMlV2Y0c1bk8ySmhjMlUyTkN4cFZrSlBVbmN3UzBkbmIwRkJRVUZPVTFWb1JWVm5RVUZCVFdkQlFVRkVTVU5CVFVGQlFVTmhhR3cyYzBGQlFVRlNWa0pOVmtWV1NHTkZlRGRFZDBKcVEzZEJVMEZuUVVoQlVVRlJRVkZDVjBOblFVVkJRVVJJUjBGRVNVZEJRVmRCWjBGRVFVRkVNVWwzV1ZaQlowTTVSbWRFUjBkQlJFZEhRVVJIUjBGQlFrRkJSREpKZDJKVVIzZEpNa0puUTJORmQwWkZNbnBvTTBGQlFVRkZXRkpUVkd4TlFTOW9iREJ3UkZnclYxQkpOblIyVVRneVYwdE5jRTU0SzJ4NlFVRkJRVVZHVTFWU1FsWklhbUUzWkdaTVltOU5kMFZGUkZKb1NWSllNMHBtUWpWMk9DOTBWVTFuVlhKeWRFcHhWVFphZWs5SlYxWXlRa3BVWjBKQlFVRkJRVUZCUVVGQlFVRkJRVUZCZDB3dlZqbDJNbXhxWkd3NGFFeHFkV1o1Tms4MGVuQk9NSGxZYlU5UFV6aDRVRlkzT0RkM1VVbDFVek0xTms4dlpGWXhNMnBZYTNCd1pWTjFNV2RxV2tZM1dGZGtaRVZsTlVkcmN6aDZlV1paT1ZrMU5VcDVTRnBzSzJOak9EVmtla3AxVVd3MFdVMW9kM2sxVUZWS2NYSmtNR05UYVd4RU16STNibGw2YmxsRmVtNXVWRnByTTBwVk1IQmlWR05RU0dwSlJrbFRPWGxVVTIxa2FDOUJZMVYwWlVRNGQyaEtTMVl3VUVWT1N6QlpVbnBJY2pkM2NUVlNObnBvU0hSRmNtWlZVeXNyV2pCSVNpOVFjakZtWldSWk9WQkdRMGQyUTBKck1tTjRhREkyTDJzMFYydG5lamQwTjBOMVIzUkVORGhqVkVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVGQlFVRkJRVUZCUVVFdmNsSjJVek5qWlVkbllTdHJVekJCUVVGQlFWTlZWazlTU3pWRFdVbEpQU0l2UGp3dmMzWm5QZz09IiwgImF0dHJpYnV0ZXMiOlt7InRyYWl0X3R5cGUiOiJUeXBlIiwidmFsdWUiOiJDb3EifSx7InRyYWl0X3R5cGUiOiJCYWNrZ3JvdW5kIiwidmFsdWUiOiJXaGl0ZSJ9LHsidHJhaXRfdHlwZSI6IkFjY2Vzc29yeSIsInZhbHVlIjoiUm9zZSJ9LHsidHJhaXRfdHlwZSI6IkJvZHkiLCJ2YWx1ZSI6IkRhcmsifSx7InRyYWl0X3R5cGUiOiJXZWFwb24iLCJ2YWx1ZSI6IlN0aWNrIn0seyJ0cmFpdF90eXBlIjoiSGVhZCIsInZhbHVlIjoiTG9yZCJ9LHsidHJhaXRfdHlwZSI6IkdlbmVyYXRpb24iLCJ2YWx1ZSI6IkdlbiAxIn0seyJ0cmFpdF90eXBlIjoiSXMgUmV2ZWFsZWQiLCJ2YWx1ZSI6IlllcyJ9XX0=', 'name': 'Coq #24818'}, 'nft_id': 'avalanche/0x993869979f9f3e8269790c478eb55f1a43827981/24818', 'permalink': 'https://opensea.io/assets/avalanche/0x993869979f9f3e8269790c478eb55f1a43827981/24818'}, 'listing_type': None, 'maker': {'address': '0xe95fe75b8211ff7101ee6c68c3e743f5ff6c0b33'}, 'order_hash': '0xf387c7d0ca46edf7e75be7537f17d278ec2934e32bbe4138dee2f94ca20a8a53', 'payment_token': {'address': '0x0000000000000000000000000000000000000000', 'decimals': 18, 'eth_price': '0.012810010000000', 'name': 'AVAX', 'symbol': 'AVAX', 'usd_price': '29.940000000000001000'}, 'protocol_address': '0x00000000000000adc04c56bf30ac9d3c0aaf14dc', 'protocol_data': {'parameters': {'conduitKey': '0x0000007b02230091a7ed01230072f7006a004d60a8d4e71d599b8104250f0000', 'consideration': [{'endAmount': '194970251000000000', 'identifierOrCriteria': '0', 'itemType': 0, 'recipient': '0xE95Fe75B8211fF7101EE6c68c3e743f5fF6c0B33', 'startAmount': '194970251000000000', 'token': '0x0000000000000000000000000000000000000000'}, {'endAmount': '4999750000000000', 'identifierOrCriteria': '0', 'itemType': 0, 'recipient': '0x0000a26b00c1F0DF003000390027140000fAa719', 'startAmount': '4999750000000000', 'token': '0x0000000000000000000000000000000000000000'}, {'endAmount': '19999000000000', 'identifierOrCriteria': '0', 'itemType': 0, 'recipient': '0xf4b16a8a8371B650D8D734C52F5656fdE9C047B8', 'startAmount': '19999000000000', 'token': '0x0000000000000000000000000000000000000000'}], 'counter': 0, 'endTime': '1708661580', 'offer': [{'endAmount': '1', 'identifierOrCriteria': '24818', 'itemType': 2, 'startAmount': '1', 'token': '0x993869979F9F3E8269790C478eB55f1A43827981'}], 'offerer': '0xe95fe75b8211ff7101ee6c68c3e743f5ff6c0b33', 'orderType': 0, 'salt': '0x360c6ebe0000000000000000000000000000000000000000bd011544efa396cc', 'startTime': '1705983303', 'totalOriginalConsiderationItems': 3, 'zone': '0x0000000000000000000000000000000000000000', 'zoneHash': '0x0000000000000000000000000000000000000000000000000000000000000000'}, 'signature': None}, 'quantity': 1, 'sale_price': '99999900000999000000000', 'taker': {'address': '0xef7487a0603671a7e6ebdf7ef0f6f88a75e99c46'}, 'transaction': {'hash': '0x400d876bd4a1198b1ebc465264053f717151b16e2a28f53d872ca75a1e942071', 'timestamp': '2024-01-23T04:17:33.000000+00:00'}}, 'sent_at': '2024-01-23T04:17:41.418807+00:00'}

test2=extract_sold_item_info(test)
# Extract the necessary values from the payload
# Extract the necessary values from the payload
sale_price_str = test['payload']['sale_price']
usd_price_str = test['payload']['payment_token']['usd_price']

# Convert the sale price and USD price to float
sale_price = float(sale_price_str) / 1e18
usd_price = float(usd_price_str)

# Calculate the total sale price in USD
total_usd = sale_price * usd_price

# Format the total sale price with comma separation and two decimal places
formatted_usd = "{:,.2f}".format(total_usd)


print(formatted_usd)